#### **Q: Что делать, если возникает ошибка «Account "..." is over disk space limit (node count limit, etc)»?**

**A:** Сообщение говорит о том, что переполнилась одна из квот аккаунта. В системе действуют квоты на ресурсы различных видов. Подробнее о видах квот, а также формы для их изменения читайте в разделе [Квоты](../../user-guide/storage/quotas.md).

------
#### **Q: Как найти, кто занимает место в аккаунте или все ноды с определенным аккаунтом?**

**A:**  Попробуйте найти данные одним из этих способом:
1. Посмотрите в корзину (`//tmp/trash/by-account/<account_name>`). Для этого стоит перейти по указанному пути в разделе **Navigation** в веб-интерфейсе;
{% if audience == "internal" %}
2. Изучите вкладку Detailed Usage на странице аккаунта (но имейте в виду, что информация там обновляется со значительной задержкой);
{% endif %}
3. Поищите с помощью `yt find <path> --name "*" --account <account_name>` таблицы под вашим аккаунтом в `//tmp` и связных с вами проектных директориях. Обратите внимание, что `yt find` не заходит в директории, в которые у вас нет доступа;
{% if audience == "internal" %}
4. Данные могут быть удалены из Кипариса, но использоваться выполняющимися операциями. Такие операции можно поискать с помощью скрипта [find_top_operations](https://a.yandex-team.ru/arc/trunk/arcadia/yt/yt/scripts/find_top_operations), например так: `./find_top_operations --proxy hahn --in-account dev`
{% endif %}

------
#### **Q: Как изменить аккаунт таблицы?**

**A:** `yt set //path/to/table/@account my-account`

------
#### **Q: Как узнать, сколько ресурсов занимает директория, включая все содержащиеся в ней таблицы, файлы и т. д.?**

**A:** `yt get //path/to/dir/@recursive_resource_usage` или выбрать **Show all resources** в разделе **Navigation** в веб-интерфейсе.

------
#### **Q: При работе с системой возникла ошибка «Transaction has expired or was aborted». Что она означает и как с ней бороться?**

**A:** При создании мастер-транзакции указывается **таймаут**, и пользователь обязуется посылать пинги транзакции не реже раза в указанный промежуток времени. Если с момента создания или последнего пинга проходит время, превышающее таймаут, система прерывает транзакцию.  Причины такого поведения могут быть следующие:

1. Проблемы сетевого взаимодействия между клиентской машиной и кластером;
2. Некорректная работа клиента — отсутствие отправки пингов. Пинги либо не отправляются по коду, либо код, выполняющий такую отправку, не вызывается. Например, в случае использования python такое может случиться, если в программе на долгое время происходит взятие GIL-блокировки при работе с какими-либо нативными библиотеками;
3. Ведутся работы на кластере;
4. Имеются известные проблемы доступности;
5. Транзакция была явно прервана клиентом, в чём можно убедиться, изучив логи сервера.

В остальных случаях для изучения проблемы необходимы клиентские debug-логи. На серверной стороне лишь известно, что пингов нет, поэтому следует обязательно включить debug-логирование и собрать debug logs. Например, выставив переменную `YT_LOG_LEVEL=debug`, что подходит для большинства поддерживаемых API.

-----
#### **Q: На странице операции появилось сообщение «"owners" field in spec ignored as it was specified simultaneously with "acl"». Что это значит?** { #ownersinspecignored }

**A:** Сообщение означает, что в спецификации операции указаны одновременно устаревшее поле «owners» и поле «acl», при этом приоритет отдан последнему, то есть поле «owners» было проигнорировано.

------
#### **Q: Как можно автоматически ротировать узлы, удалять старше определенного времени?**

**A:** Следует воспользоваться атрибутом `expiration_time`. Подробнее можно прочитать в разделе [Дерево метаинформации](../../user-guide/storage/cypress.md#TTL).

------
#### **Q: Как можно автоматически удалять узлы, которыми не пользовались дольше определенного времени?**

**A:** Следует воспользоваться атрибутом `expiration_timeout`. Подробнее можно прочитать в разделе [Дерево метаинформации](../../user-guide/storage/cypress.md#TTL).

------
#### **Q: В ходе работы операции появилось предупреждение «Detected excessive disk IO in <job_type> jobs. IO throttling was activated». Что это значит?** { #excessivediskusage }

**A:** Джобы операции совершают много операций ввода/вывода с локальным диском. Чтобы минимизировать негативные последствия такого поведения для кластера, джобы были ограничены через механизм [троттлинга blkio cgroup](https://www.kernel.org/doc/Documentation/cgroup-v1/blkio-controller.txt). О возможных причинах подобного поведения в примерах раздела [Статистики джобов](../../user-guide/problems/jobstatistics.md#excessive_io).


------
#### **Q: Какие пути веб-интерфейс исправляет автоматически при включённой настройке Enable path autocorrection?** { #enablepathautocorrection }

**A:** Веб-интерфейс не сообщает о том, какие ошибки в пути были исправлены.
Например, `//home/user/tables/` — путь такого вида всегда невалидный, при отображении пути в веб-интерфейсе неэкранированный слеш в конце пути будет отброшен.

------
#### **Q: Как понять успешно ли скачалась таблица из веб-интерфейса, а если нет, как посмотреть ошибку?** { #web_interface_table_download }

**A:** При возникновении ошибки она будет записываться в скачиваемый файл. Ошибка может произойти в любой момент во время скачивания — необходимо проверять конец файла. Пример ошибки:

```json
==================================================================" "# "" ""#
{
    "code" = 1;
    "message" = "Missing key column \"key\" in record";
    "attributes" = {
        "fid" = 18446479488923730601u;
        "tid" = 9489286656218008974u;
        "datetime" = "2017-08-30T15:49:38.645508Z";
        "pid" = 864684;
        "host" = "<cluster_name>";
    };
}
==================================================================" "# "" ""#
```

------
#### **Q: Вы пытаетесь локально запустить программу, которая обращается через RPC в {{product-name}}, и получаете ошибку «Domain name not found»**

**A:** В логе также можно встретить `W Dns DNS resolve failed (HostName: your-local-host-name)`. Ошибка возникает при разрешении имени локального хоста, а в глобальном DNS его нет. Дело в том, что {{product-name}} RPC client по умолчанию использует IPv6 и отключает IPv4. Поэтому строка `127.0.1.1  your-local-host-name` в локальном файле `/etc/hosts` не работает. Если дописать в указанный файл `::1  your-local-host-name`, это должно решить проблему.

------
#### **Q: Как скопировать не всю таблицу, а только некоторый диапазон строк?**

**A:** В текущей реализации операция `Copy` не поддерживает копирование диапазонов, но можно воспользоваться командой [Merge](../../user-guide/data-processing/operations/merge.md), она отработает быстро. При использовании режима `ordered` сохранится сортировка в простых случаях (например, когда диапазон один). Пример команды:

```bash
yt merge --src '_path/to/src/table[#100:#500]' --dst _path/to/dst/table --mode ordered
```

------
#### **Q: Как узнать, кто работает с моими таблицами?**

**A:** Для этого можно проанализировать лог доступа к мастер-серверу.

------
#### **Q: Как восстановить удаленные данные?**

**A:** Если удаление было через UI и там не была выбрана опция `Delete permanently`, то можно поискать таблицы в мусорке в папке соответствующего аккаунта.
Если удаление было через `yt remove` или аналогичные вызовы API, то восстановление **невозможно**.

------
#### **Q: Ошибка «Operations of type "remote-copy" must have small enough specified resource limits in some of ancestor pools»**

**A:** Операции [RemoteCopy](../../user-guide/data-processing/operations/remote-copy.md) создают нагрузку на cross-DC сеть.
Для ограничения нагрузки было введено искусственное ограничение: операции RemoteCopy должны запускаться в пуле с лимитом на `user_slots`. Лимит указан в тексте ошибки и чаще всего равен `2000`.

Если в пуле планируется запускать только RemoteCopy, то достаточно выставить это ограничение для пула
`yt set //sys/pools/..../your_pool/@resource_limits '{user_slots=2000}'`.

{% if audience == "internal" %}

Более подробно: https://ignat.at.yandex-team.ru/326/

------
#### **Q: Не создался пользователь на кластере для робота. Токен при этом получить смогли.**

**A:** Для того, чтобы роботный пользователь появился на кластере необходимо запросить через [IDM](https://idm.yandex-team.ru/) доступ роботу в одну из групп в соответствующей системе [IDM](https://idm.yandex-team.ru/systems#sort-by=name,f-system-status=active). Подробнее про токены можно прочесть в разделе [Как попробовать](../../quickstart.md#how-to-get-oauth-token).

------
#### **Q: Можно ли выдать доступ через {{product-name}} ACL на ABC-сервис?**

**A:** В {{product-name}} ACL указываются либо пользователи {{product-name}}, либо группы {{product-name}}. Тем самым, задача сводится к тому, чтобы узнать, есть ли в {{product-name}} группа, отвечающая заданному ABC-сервису, и как она называется. Проще всего дать ответ, если где-либо в IDM на данный сервис выдана хотя бы одна роль в {{product-name}}, например на чтение или запись в каталог. В таком случае следует пойти в {{product-name}} UI на вкладку ACL каталога и найти там соответствующую строчку. В ней имя группы будет иметь вид `idm-group:N`, где N — некоторое число (внутренний идентификатор IDM). Именно эту строчку и нужно указывать во всех ACL, где требуется выдать доступ на ABC-сервис. Если же на сервис не выдано ни одной роли в {{product-name}}, то нужно выдать группе роль на любой каталог. Пока у группы есть хотя бы одна роль на кластере, её состав будет синхронизироваться с IDM и ABC.

------
#### **Q: При запуске операции из python wrapper от роботного пользователя получаю ошибку "permission for node //tmp/yt_wrapper/file_storage is not allowed by any matching ACE"**

**A:** У робота нет доступа к `/tmp`, необходимо запросить для робота роль **group member yandex**  через [IDM](https://idm.yandex-team.ru/). Подробнее можно узнать в разделе [Аутентификация](../../user-guide/storage/auth.md#getting_token_for_robot).


#### **Q: Как узнать, валиден ли токен, от какого он пользователя и принимает ли его конкретный кластер?**

**A:** К примеру, если вы получили ошибку аутентификации:
`Your authentication token was rejected by the server (X-YT-Request-ID: 6e101e7733a31832). Please refer to http:<cluster_fqdn>/auth/ for obtaining a valid token`, следует отправить HTTP-запрос с токеном в вызов /auth:

`curl -H 'Authorization: OAuth ${TOKEN}' http://<cluster_fqdn>/auth/whoami`

{% endif %}

------
#### **Q: При чтении или копировании таблицы получаю ошибку "Access denied for user "some_user": "full_read" permission for node //home/some_table is not allowed by any matching ACE"**

**A:** В таблице одна или несколько колонок закрыты по ACL, и у вас нет к ним доступа. Чтобы свершить задуманное, необходимо этот доступ получить. Подробнее см. в разделе [Управление доступом к колонкам таблиц](../../user-guide/storage/columnar-acl.md).

