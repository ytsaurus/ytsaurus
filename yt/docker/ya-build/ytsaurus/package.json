{
    "meta": {
        "name": "ytsaurus",
        "maintainer": "YT team",
        "description": "Core YTsaurus image built with yt client libraries from source files",
        "version": "local-{revision}",
    },
    "include": [
      "yt/docker/ya-build/base/package.json",
    ],
    "params": {
        "format": "docker",
        "docker_target": "ytsaurus",
        "docker_build_arg": {
            "PYTHON_BUILD_BASE": "build-ytsaurus-python-binaries"
        },
    },
    "build": {
        "build_dynamic_libraries": {
            "targets": [
                "contrib/libs/libiconv/dynamic",
            ],
            "build_type": "profile",
            "thinlto": true,
            "target-platforms": [
                "default-linux-x86_64",
            ],
            "flags": [
                {
                    "name": "NO_STRIP",
                    "value": "yes",
                },
            ],
        },
    },
    "data": [
        {
            "source": {
                "type": "ARCADIA",
                "path": "yt/python/yt/environment",
                "files": [
                    "init_queue_agent_state.py",
                    "init_operations_archive.py",
                ],
            },
            "destination": {
                "path": "/",
            },
        },
        {
            "source": {
                "type": "BUILD_OUTPUT",
                "build_key": "build_dynamic_libraries",
                "path": "contrib/libs/libiconv/dynamic/libiconv.so",
            },
            "destination": {
                "path": "/artifacts/libiconv.so",
            },
        },
    ],
}
